{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "f7cb0dd7",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import seaborn as sns\n",
    "import matplotlib.pyplot as plt\n",
    "import numpy as np\n",
    "from sklearn.model_selection import train_test_split\n",
    "from xgboost import XGBRegressor\n",
    "from sklearn import preprocessing\n",
    "from collections import defaultdict, Counter\n",
    "from nltk.util import ngrams\n",
    "import collections\n",
    "import nltk\n",
    "import warnings\n",
    "import xgboost as xgb\n",
    "from sklearn.utils import class_weight\n",
    "from sklearn import metrics\n",
    "from sklearn.metrics import  precision_score, recall_score\n",
    "warnings.filterwarnings(\"ignore\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "da0b4a79",
   "metadata": {},
   "outputs": [],
   "source": [
    "wp_thresholds = [0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 0.99]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "77d642f9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.0033333333333333335"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "FILTHER_THRESHOLD = 1.0/300\n",
    "FILTHER_THRESHOLD"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "b8dc6f3b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "10000"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = pd.read_parquet('home_assignment_data.parquet')\n",
    "len(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "877502eb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "9991"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = df[df['days_since_install'].notnull()]\n",
    "len(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "d3dfad7d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>is_subscriber</th>\n",
       "      <th>country</th>\n",
       "      <th>language</th>\n",
       "      <th>days_since_install</th>\n",
       "      <th>followers_count</th>\n",
       "      <th>has_facebook</th>\n",
       "      <th>has_youtube</th>\n",
       "      <th>has_instagram</th>\n",
       "      <th>has_tiktok</th>\n",
       "      <th>has_snapchat</th>\n",
       "      <th>...</th>\n",
       "      <th>feature_types</th>\n",
       "      <th>start_times</th>\n",
       "      <th>feature_durations</th>\n",
       "      <th>replaceable_count</th>\n",
       "      <th>transitions_count</th>\n",
       "      <th>audio_embedding</th>\n",
       "      <th>visual_embedding</th>\n",
       "      <th>post_timestamp</th>\n",
       "      <th>impressions</th>\n",
       "      <th>clicks</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>5136</th>\n",
       "      <td>False</td>\n",
       "      <td>HU</td>\n",
       "      <td>en-HU</td>\n",
       "      <td>128.0</td>\n",
       "      <td>12</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>[Text, Clip]</td>\n",
       "      <td>[1.477, 0.0]</td>\n",
       "      <td>[0.4923333333333333, 21.1]</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>[-0.8035852313041687, 0.4065600037574768, -0.9...</td>\n",
       "      <td>[-0.327392578125, -0.1810302734375, 0.46435546...</td>\n",
       "      <td>2022-10-02 14:12:46.667000+00:00</td>\n",
       "      <td>116</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2885</th>\n",
       "      <td>True</td>\n",
       "      <td>US</td>\n",
       "      <td>en-US</td>\n",
       "      <td>772.0</td>\n",
       "      <td>0</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>[Mixer, Text, Text, Text, Text, Text, Clip, Cl...</td>\n",
       "      <td>[1.3141, 0.68205, 1.8426, 13.384683333333333, ...</td>\n",
       "      <td>[1.50735, 1.1319833333333333, 1.20906666666666...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>[-0.6472129821777344, -0.5502700209617615, -0....</td>\n",
       "      <td>[0.3112284243106842, -0.1690673828125, -0.0603...</td>\n",
       "      <td>2022-09-29 00:46:44.510000+00:00</td>\n",
       "      <td>104</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2 rows Ã— 24 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      is_subscriber country language  days_since_install  followers_count  \\\n",
       "5136          False      HU    en-HU               128.0               12   \n",
       "2885           True      US    en-US               772.0                0   \n",
       "\n",
       "      has_facebook  has_youtube  has_instagram  has_tiktok  has_snapchat  ...  \\\n",
       "5136         False        False          False       False         False  ...   \n",
       "2885         False        False          False       False         False  ...   \n",
       "\n",
       "                                          feature_types  \\\n",
       "5136                                       [Text, Clip]   \n",
       "2885  [Mixer, Text, Text, Text, Text, Text, Clip, Cl...   \n",
       "\n",
       "                                            start_times  \\\n",
       "5136                                       [1.477, 0.0]   \n",
       "2885  [1.3141, 0.68205, 1.8426, 13.384683333333333, ...   \n",
       "\n",
       "                                      feature_durations  replaceable_count  \\\n",
       "5136                         [0.4923333333333333, 21.1]                  1   \n",
       "2885  [1.50735, 1.1319833333333333, 1.20906666666666...                  0   \n",
       "\n",
       "     transitions_count                                    audio_embedding  \\\n",
       "5136                 0  [-0.8035852313041687, 0.4065600037574768, -0.9...   \n",
       "2885                 0  [-0.6472129821777344, -0.5502700209617615, -0....   \n",
       "\n",
       "                                       visual_embedding  \\\n",
       "5136  [-0.327392578125, -0.1810302734375, 0.46435546...   \n",
       "2885  [0.3112284243106842, -0.1690673828125, -0.0603...   \n",
       "\n",
       "                       post_timestamp  impressions clicks  \n",
       "5136 2022-10-02 14:12:46.667000+00:00          116      0  \n",
       "2885 2022-09-29 00:46:44.510000+00:00          104      0  \n",
       "\n",
       "[2 rows x 24 columns]"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.sample(2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "c7924cc3",
   "metadata": {},
   "outputs": [],
   "source": [
    "df['convergance'] = 100 * (df['clicks'] / df['impressions'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "1f0da959",
   "metadata": {},
   "outputs": [],
   "source": [
    "df['feature_types'] = df['feature_types'].apply(lambda features: [feature.strip().lower() for feature in features])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "17587a7c",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "df['unique_feature_types'] = df['feature_types'].apply(lambda features: list(set(features)))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "daa5d7fd",
   "metadata": {},
   "outputs": [],
   "source": [
    "df['language_clean'] = df['language'].apply(lambda language: language.split('-')[0])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "d65262d2",
   "metadata": {},
   "outputs": [],
   "source": [
    "df['number_of_feature_types'] = df['feature_types'].apply(len)\n",
    "df['number_of_unique_feature_types'] = df['unique_feature_types'].apply(len)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "8dcb0ea7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(7992, 1999)"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_df, test_df = train_test_split(df, test_size = 0.2)\n",
    "\n",
    "len(train_df), len(test_df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "a0c9f69c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'FEATURE_UNK'"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "UNK_FEATURTE = 'FEATURE_UNK'\n",
    "FEATURE_MIN_TEMPLATES = 5\n",
    "UNK_FEATURTE"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "772606fc",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "38"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "all_unique_features = {feature for features in train_df['unique_feature_types'].tolist() for feature in features}\n",
    "len(all_unique_features) "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "dcc6b0e1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "32"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "feature_types_counter = Counter([feature for features in train_df['unique_feature_types'].tolist() for feature in features])\n",
    "valid_features = {feature for (feature, count) in  feature_types_counter.items() if count > FEATURE_MIN_TEMPLATES}\n",
    "valid_features.add(UNK_FEATURTE)\n",
    "len(valid_features)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "769962df",
   "metadata": {},
   "outputs": [],
   "source": [
    "features_lists = train_df['feature_types'].tolist()\n",
    "features_lists = [['start']  + f + ['end'] for f in features_lists]\n",
    "\n",
    "feature_counts = Counter()\n",
    "\n",
    "for features in features_lists:\n",
    "    feature_counts.update(nltk.ngrams(features, 1))\n",
    "    feature_counts.update(nltk.ngrams(features, 2))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "48f11632",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(13, 45)"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "language_count = df.groupby(['language_clean']).size().to_frame('size').reset_index()\n",
    "valid_languages = set(language_count[language_count['size'] > 50]['language_clean'])\n",
    "UNK_LANGUAGE = 'UNK_LANGUAGE'\n",
    "len(valid_languages), len(pd.unique(df['language_clean']))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "519298c3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(28, 145)"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "country_count = df.groupby(['country']).size().to_frame('size').reset_index()\n",
    "valid_countries = set(country_count[country_count['size'] > 50]['country'])\n",
    "UNK_COUNTRY = 'UNK_COUNTRY'\n",
    "len(valid_countries), len(pd.unique(df['country']))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "1544e832",
   "metadata": {},
   "outputs": [],
   "source": [
    "train_df['country'] = train_df['country'].apply(lambda country: country if country in valid_countries else UNK_COUNTRY)\n",
    "train_df['language_clean'] = train_df['language_clean'].apply(lambda language_clean: language_clean if language_clean in valid_languages else UNK_LANGUAGE)\n",
    "\n",
    "test_df['country'] = test_df['country'].apply(lambda country: country if country in valid_countries else UNK_COUNTRY)\n",
    "test_df['language_clean'] = test_df['language_clean'].apply(lambda language_clean: language_clean if language_clean in valid_languages else UNK_LANGUAGE)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "2979f287",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(array(['en', 'de', 'ru', 'pt', 'es', 'uk', 'UNK_LANGUAGE', 'ar', 'it',\n",
       "        'fr', 'pl', 'tr', 'sv', 'nl'], dtype=object),\n",
       " array(['US', 'UNK_COUNTRY', 'TR', 'BR', 'GB', 'KZ', 'UA', 'ES', 'CA',\n",
       "        'JP', 'BY', 'IN', 'RU', 'MX', 'SA', 'IT', 'CH', 'EG', 'KW', 'DE',\n",
       "        'FR', 'PL', 'NL', 'AE', 'IQ', 'AU', 'SE', 'IL', 'CO'], dtype=object))"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "country_encoder = preprocessing.LabelEncoder()\n",
    "language_clean_encoder = preprocessing.LabelEncoder()\n",
    "country_encoder.fit(train_df['country'])\n",
    "language_clean_encoder.fit(train_df['language_clean'])\n",
    "pd.unique(train_df['language_clean']), pd.unique(train_df['country'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "51e0bb41",
   "metadata": {},
   "outputs": [],
   "source": [
    "def count_feature(feature_types):\n",
    "    feature_to_count = defaultdict(lambda: 0.)\n",
    "    \n",
    "    for feature in feature_types:\n",
    "        feature_to_count[feature] += 1\n",
    "    return feature_to_count\n",
    "\n",
    "def get_feature_duration(feature_types, features_duration):\n",
    "    feature_to_duration = defaultdict(lambda: 0.)\n",
    "    \n",
    "    for (feature, duration) in zip(feature_types, features_duration):\n",
    "        feature_to_duration[feature] += duration\n",
    "    return feature_to_duration\n",
    "\n",
    "def get_feature_min_start_time(feature_types, features_start_times):\n",
    "    feature_to_min_start_time = defaultdict(lambda: -1)\n",
    "    \n",
    "    for (feature, start_time) in zip(feature_types, features_start_times):\n",
    "        \n",
    "        if feature in feature_to_min_start_time:\n",
    "            continue \n",
    "            \n",
    "        feature_to_min_start_time[feature] = start_time\n",
    "        \n",
    "    return feature_to_min_start_time\n",
    "\n",
    "\n",
    "def get_feature_min_max_median_duration(durations, features, target_feature):\n",
    "    durations = [duration for (feature, duration) in  zip(features ,durations) if feature == target_feature] \n",
    "    \n",
    "    if len(durations) == 0:\n",
    "        return pd.Series([-1, -1, -1])\n",
    "    \n",
    "    \n",
    "    return pd.Series([np.min(durations), np.max(durations), np.median(durations)])\n",
    "    \n",
    "\n",
    "\n",
    "def create_grams_features(dataset):\n",
    "    \n",
    "    features_lists = dataset['feature_types'].tolist()\n",
    "    features_lists = [['start']  + f + ['end'] for f in features_lists]\n",
    "    \n",
    "    vals = []\n",
    "    max_vals = []\n",
    "    min_vals = []\n",
    "    mean_probs = []\n",
    "    median_probs = []\n",
    "\n",
    "    \n",
    "    for l in features_lists:\n",
    "        p1 = []\n",
    "        for i in range(len(l) -1):\n",
    "            s = l[i]\n",
    "            e = l[i + 1]\n",
    "\n",
    "            x1 = feature_counts[tuple([s, e])]\n",
    "            x2 = feature_counts[tuple([s])]\n",
    "\n",
    "            p2 =  x1/x2 if x2 > 0 else 0.\n",
    "            p1.append(p2)\n",
    "        \n",
    "        x = np.prod(p1)\n",
    "        vals.append(x)\n",
    "        max_vals.append(np.max(p1))\n",
    "        min_vals.append(np.min(p1))\n",
    "        mean_probs.append(np.mean(p1))\n",
    "        median_probs.append(np.median(p1))\n",
    "\n",
    "        \n",
    "    dataset['features_prob'] = vals\n",
    "    dataset['min_prob'] = min_vals\n",
    "    dataset['max_prob'] = max_vals\n",
    "    dataset['mean_probs'] = mean_probs\n",
    "    dataset['median_probs'] = median_probs\n",
    "    \n",
    "    return dataset\n",
    "\n",
    "def get_label(convergence):\n",
    "    \n",
    "    if convergence < FILTHER_THRESHOLD:\n",
    "        return 0 \n",
    "    \n",
    "    return 1\n",
    "\n",
    "\n",
    "def tfidf_scores(features):\n",
    "    \n",
    "    tfidfs = defaultdict(lambda: -1)\n",
    "    \n",
    "    feature_to_count = count_feature(features)\n",
    "    for feature in features:\n",
    "        count = feature_to_count[feature]\n",
    "        tf = count/len(features)\n",
    "        \n",
    "        numbwr_of_documents_with_feature = feature_to_number_of_documents[feature] if feature_to_number_of_documents[feature] > 0 else 0.\n",
    "        \n",
    "        idf = np.log(len(train_df)/numbwr_of_documents_with_feature) if numbwr_of_documents_with_feature > 0 else 0.\n",
    "        \n",
    "        tfidfs[feature] = tf * idf\n",
    "    \n",
    "    return tfidfs\n",
    "        \n",
    "def tfidf_duration_scores(features, features_duration, duration):\n",
    "    \n",
    "    tfidfs = defaultdict(lambda: -1)\n",
    "    feature_to_count = get_feature_duration(features, features_duration)\n",
    "    \n",
    "    for feature in features:\n",
    "        count = feature_to_count[feature]\n",
    "        tf = count/duration\n",
    "        \n",
    "        numbwr_of_documents_with_feature = feature_to_number_of_documents[feature] if feature_to_number_of_documents[feature] > 0 else 0.\n",
    "        \n",
    "        idf = np.log(len(train_df)/numbwr_of_documents_with_feature) if numbwr_of_documents_with_feature > 0 else 0.\n",
    "        \n",
    "        tfidfs[feature] = tf * idf\n",
    "    \n",
    "    return tfidfs\n",
    "\n",
    "\n",
    "def create_features(dataset):\n",
    "    \n",
    "    dataset = dataset.copy(True)\n",
    "    \n",
    "    dataset['feature_types_clean'] = dataset['feature_types'].apply(lambda features: [UNK_FEATURTE if feature not in valid_features else feature for feature in features])\n",
    "    \n",
    "    dataset['number_of_unk_features'] = dataset['feature_types'].apply(lambda features: len([1 for feature in features if feature not in valid_features ]))\n",
    "    \n",
    "    dataset['feature_count'] = dataset['feature_types_clean'].apply(count_feature)\n",
    "    dataset['features_to_duration'] = dataset.apply(lambda r: get_feature_duration(r['feature_types_clean'], r['feature_durations']), axis=1)\n",
    "    dataset['features_to_start_time'] = dataset.apply(lambda r: get_feature_min_start_time(r['feature_types_clean'], r['start_times']), axis=1)\n",
    "    dataset['transition_to_duration'] = dataset['transitions_count']/dataset['duration']\n",
    "    \n",
    "    dataset['duration_to_unique_features'] = dataset['duration']/dataset['number_of_unique_feature_types']\n",
    "    dataset['duration_to_features'] = dataset['duration']/dataset['number_of_feature_types']\n",
    "    \n",
    "    for feature in valid_features:\n",
    "        dataset[f'{feature}_duration'] = dataset['features_to_duration'].apply(lambda features_to_duration: features_to_duration[feature])\n",
    "        dataset[f'{feature}_start_time'] = dataset['features_to_start_time'].apply(lambda features_to_start_time: features_to_start_time[feature])\n",
    "        dataset[f'{feature}_count'] = dataset['feature_count'].apply(lambda feature_count: feature_count[feature])\n",
    "    \n",
    "   \n",
    "    for feature in valid_features:\n",
    "        dataset[[f'{feature}_min', f'{feature}_max', f'{feature}_median']] =  dataset.apply(lambda r: get_feature_min_max_median_duration(r['feature_durations'], r['feature_types_clean'], feature) , axis=1) \n",
    " \n",
    "    dataset['tfidf_scores'] = dataset['feature_types'].apply(tfidf_scores)\n",
    "    #dataset['tfidf_scores'] = dataset.apply(lambda r: tfidf_scores(r['feature_types'], r['feature_durations'], r['duration']), axis=1)\n",
    "    \n",
    "    dataset['tfidf_duration_scores'] = dataset.apply(lambda r: tfidf_duration_scores(r['feature_types'], r['feature_durations'], r['duration']), axis=1)\n",
    "    \n",
    "    \n",
    "    \n",
    "    \n",
    "    for feature in all_unique_features:\n",
    "        dataset['tfidf_duration_{feature}'] = dataset['tfidf_duration_scores'].apply(lambda tfidf_scores: tfidf_scores[feature])\n",
    "        dataset['tfidf_{feature}'] = dataset['tfidf_scores'].apply(lambda tfidf_scores: tfidf_scores[feature])\n",
    "        \n",
    "        \n",
    "    \n",
    "    dataset['post_hour'] = dataset['post_timestamp'].apply(lambda pt: pt.hour)\n",
    "    #dataset['post_year'] = dataset['post_timestamp'].apply(lambda pt: pt.year)\n",
    "    dataset['post_month'] = dataset['post_timestamp'].apply(lambda pt: pt.month)\n",
    "    dataset['post_weekday'] = dataset['post_timestamp'].apply(lambda pt: pt.weekday())\n",
    "    dataset['country'] = country_encoder.transform(dataset['country'])\n",
    "    dataset['language_clean'] = language_clean_encoder.transform(dataset['language_clean'])\n",
    "\n",
    "    create_grams_features(dataset)\n",
    "    \n",
    "    y = dataset['convergance'].apply(get_label).tolist()\n",
    "    \n",
    "    dataset.drop(columns = ['feature_count', 'features_to_duration', 'features_to_start_time',\n",
    "                           'post_timestamp', 'feature_types',\n",
    "                            'start_times', 'feature_durations',\n",
    "                            'audio_embedding', 'visual_embedding',\n",
    "                            'impressions', 'clicks',\n",
    "                           'convergance', 'unique_feature_types',\n",
    "                           'language', 'feature_types_clean', 'tfidf_scores',\n",
    "                           'tfidf_duration_scores'], inplace = True)\n",
    "        \n",
    "    return dataset, y\n",
    "        \n",
    "    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "75efc547",
   "metadata": {},
   "outputs": [],
   "source": [
    "all_features = {feature for features in train_df['feature_types'] for feature in features }\n",
    "\n",
    "feature_to_number_of_documents = defaultdict(lambda: 0.0)\n",
    "\n",
    "for feature in all_features:\n",
    "    number_of_rows_with_feature = train_df[train_df['feature_types'].map(lambda features: feature in features) == True].shape[0]\n",
    "    feature_to_number_of_documents[feature] = number_of_rows_with_feature\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "86afcf21",
   "metadata": {},
   "outputs": [],
   "source": [
    "train_features, train_y = create_features(train_df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "329d6c11",
   "metadata": {},
   "outputs": [],
   "source": [
    "test_features, test_y = create_features(test_df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "5b9d9ca3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[1.1701317715959005, 0.8730609569587066]"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "classes_weights = list(class_weight.compute_class_weight(class_weight = 'balanced',\n",
    "                                                         classes = np.unique(train_y),\n",
    "                                                         y = train_y))\n",
    "\n",
    "weights = np.ones(len(train_y), dtype = 'float')\n",
    "for i, val in enumerate(train_y):\n",
    "    weights[i] = classes_weights[val]\n",
    "\n",
    "classes_weights"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "d13fb5b8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "XGBClassifier(base_score=0.5, booster='gbtree', callbacks=None,\n",
       "              colsample_bylevel=1, colsample_bynode=1, colsample_bytree=0.4,\n",
       "              early_stopping_rounds=None, enable_categorical=False,\n",
       "              eval_metric=None, gamma=0.4, gpu_id=-1, grow_policy='depthwise',\n",
       "              importance_type=None, interaction_constraints='',\n",
       "              learning_rate=0.300000012, max_bin=256, max_cat_to_onehot=4,\n",
       "              max_delta_step=0, max_depth=6, max_leaves=0, min_child_weight=1,\n",
       "              missing=nan, monotone_constraints='()', n_estimators=10, n_jobs=0,\n",
       "              num_parallel_tree=1, predictor='auto', random_state=0,\n",
       "              reg_alpha=0, reg_lambda=1, ...)"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "clf = xgb.XGBClassifier(n_estimators=10, subsample = 0.5, max_depth = 6, colsample_bytree = 0.4,\n",
    "                       gamma = 0.4)\n",
    "\n",
    "clf.fit(train_features, train_y, sample_weight=weights)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "39015bc0",
   "metadata": {},
   "outputs": [],
   "source": [
    "train_predict = clf.predict(train_features)\n",
    "test_predict = clf.predict(test_features)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "8ee2c6f4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[0.80966325, 0.19033675],\n",
       "       [0.24710509, 0.75289491]])"
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_confusion_matrix = metrics.confusion_matrix(train_y, train_predict, normalize = 'true')\n",
    "train_confusion_matrix"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "4b0f939f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[0.74736842, 0.25263158],\n",
       "       [0.31468531, 0.68531469]])"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "test_confusion_matrix = metrics.confusion_matrix(test_y, test_predict, normalize = 'true')\n",
    "test_confusion_matrix"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "9700ca73",
   "metadata": {},
   "outputs": [],
   "source": [
    "train_scores = clf.predict_proba(train_features)[:, 1]\n",
    "test_scores = clf.predict_proba(test_features)[:, 1]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "9944b2a5",
   "metadata": {},
   "outputs": [],
   "source": [
    "def calc_precision_recall(scores, labels, th):    \n",
    "    pre = precision_score(labels, scores > th)\n",
    "    rec = recall_score(labels, scores > th)\n",
    "\n",
    "    return (pre, rec, th)\n",
    "\n",
    "def plot_precision_recall(scores, labels):\n",
    "    rows = []\n",
    "    for th in wp_thresholds:\n",
    "        metric_values = calc_precision_recall(scores,  labels, th)\n",
    "        rows.append(metric_values)\n",
    "\n",
    "    metrics_df = pd.DataFrame(rows, columns =['precision', 'recall', 'th'])\n",
    "\n",
    "    fig, ax = plt.subplots()\n",
    "    sns.scatterplot(data=metrics_df, x=\"precision\", y=\"recall\", ax= ax)\n",
    "    plt.show()\n",
    "    return metrics_df.sort_values(by = ['precision'], ascending = False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "a8c8eb3c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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NTX64osvNHz4cDmdTvXA/QABAOjXvIFg2GAjSZXVXnkDwShXFHu6FW4+//xzffe739U555yjq666KrRD6oYbbmDNDQAAp8Df0NRhf10n/ehmuJkzZ44SExN18OBBJScnh9qnTJmiTZs29VhxAAD0N2muxA77UzvpRzcXFL/66qt65ZVXdPrpp7dp93g8+vjjj3ukMAAA+iMjxaF8j6HKk6y5MVL633qbSHXrzM2xY8fanLFp9cUXX8TEomIAAPoqd7JD5YU5yvcYbdrzPYYWF+b0y8XEkerWmZsJEyboD3/4gxYuXChJiouLU0tLix5++GFdccUVPVogAAD9TWZ6kpZNHS1vIKi6hialuhJlpHCfm67qVrh55JFHdOWVV+rdd99VMBjUPffco3/84x/64osvwt65GAAARMadTJjprojDTVNTk+644w79z//8j1577TWlpqYqEAjommuu0axZs8I+cwoAACBaIg43iYmJqqqq0qBBgzRv3rzeqAkAAKDburWg+Kc//ameeuqpnq4FAADglHVrzc2JEye0evVqvf766xozZowGDhzYpn/JkiU9UhwAAECkuhVu/v73v+uiiy6SJH3wwQdt+uLi4k69KgAAgG7qVrh54403eroOAACAHnFKD84EAADoawg3AADAVgg3AADAVgg3AADAVgg3AADAVgg3AADAVgg3AADAVgg3AADAVvpEuFmxYoWys7PlcrmUm5urbdu2dem4tWvXKi4uTpMnT+7dAgEA6GN89UHt+yygnQe/1L4jAfnqg1aX1Gd06w7FPWndunUqKirSypUrlZubq6VLl2rixInau3evBg8efNLjPvroI/3yl7/UhAkTolgtAADWO3z0uIrXV+nNam+oLd9jqLwwR5npSRZW1jdYfuZmyZIluummmzRz5kydd955WrlypZKTk7V69eqTHtPc3Kyf/OQneuCBB3TWWWd1+P6NjY3y+/1tXgAAxCpffbBdsJGkymqvStZXcQZHFoebYDCo7du3q6CgINQWHx+vgoICbd269aTHPfjggxo8eLBuuOGGTj+jrKxMbrc79MrKyuqR2gEAsII3EGwXbFpVVnvlDRBuLA03Xq9Xzc3NysjIaNOekZGhmpqasMe89dZbeuqpp7Rq1aoufcbcuXPl8/lCr0OHDp1y3QAAWMXf0NRhf10n/f2B5WtuIlFXV6dp06Zp1apVMgyjS8c4nU45nc5ergwAgOhIcyV22J/aSX9/YGm4MQxDCQkJqq2tbdNeW1urIUOGtBu/b98+ffTRR5o0aVKoraWlRZI0YMAA7d27V8OHD+/dogEAsJCR4lC+x1BlmEtT+R5DRorDgqr6FksvSzkcDo0ZM0YVFRWhtpaWFlVUVCgvL6/d+HPPPVe7d+/Wrl27Qq8f/ehHuuKKK7Rr1y7W0wAAbM+d7FB5YY7yPW2vYOR7DC0uzJE7mXBj+WWpoqIizZgxQ2PHjtW4ceO0dOlSHTt2TDNnzpQkTZ8+XcOGDVNZWZlcLpcuuOCCNsenp6dLUrt2AADsKjM9ScumjpY3EFRdQ5NSXYkyUhwEm//P8nAzZcoUHTlyRAsWLFBNTY1GjRqlTZs2hRYZHzx4UPHxlu9YBwCgT3EnE2ZOJs40TdPqIqLJ7/fL7XbL5/MpLS3N6nIAAEAXRPL7zSkRAABgK4QbAABgK4QbAABgK4QbAABgK4QbAABgK4QbAABgK4QbAABgK4QbAABgK4QbAABgK4QbAABgK4QbAABgK4QbAABgK4QbAABgK4QbAABgK4QbAABgK4QbAABgKwOsLgAAAPQ+X31Q3kBQ/oYmpSUlyhjokDvZYXVZvYJwAwCAzR0+elzF66v0ZrU31JbvMVRemKPM9CQLK+sdXJYCAMDGfPXBdsFGkiqrvSpZXyVffdCiynoP4QYAABvzBoLtgk2rymqvvAHCDQAAiCH+hqYO++s66Y9FhBsAAGwszZXYYX9qJ/2xiHADAICNGSkO5XuMsH35HkNGiv12TBFuAACwMXeyQ+WFOe0CTr7H0OLCHFtuB2crOAAANpeZnqRlU0fLGwiqrqFJqa5EGSnc5wYAAMQwd7J9w8w3cVkKAADYCuEGAADYCuEGAADYCuEGAADYCuEGAADYCuEGAADYCuEGAADYCuEGAADYCuEGAADYCuEGAADYCuEGAADYCuEGAADYCuEGAADYCuEGAADYCuEGAADYCuEGAADYCuEGAADYCuEGAADYCuEGAADYCuEGAADYCuEGAADYCuEGAADYCuEGAADYCuEGAADYCuEGAADYygCrCwAAAH2Drz4obyAof0OT0pISZQx0yJ3ssLqsiBFuAACADh89ruL1VXqz2htqy/cYKi/MUWZ6koWVRY7LUgAA9HO++mC7YCNJldVelayvkq8+aFFl3UO4AQCgn/MGgu2CTavKaq+8AcINAACIIf6Gpg776zrp72v6RLhZsWKFsrOz5XK5lJubq23btp107KpVqzRhwgQNGjRIgwYNUkFBQYfjAQBAx9JciR32p3bS39dYHm7WrVunoqIilZaWaseOHbrwwgs1ceJEffbZZ2HHb968WVOnTtUbb7yhrVu3KisrS9///vf1ySefRLlyAADswUhxKN9jhO3L9xgyUmJrx1ScaZqmlQXk5ubq4osv1vLlyyVJLS0tysrK0u23366SkpJOj29ubtagQYO0fPlyTZ8+vdPxfr9fbrdbPp9PaWlpp1w/AAB2cPjocZWsr1LlN3ZLLS7M0dA+sFsqkt9vS7eCB4NBbd++XXPnzg21xcfHq6CgQFu3bu3Se9TX16upqUmnnXZa2P7GxkY1NjaG/vb7/adWNAAANpSZnqRlU0fLGwiqrqFJqa5EGSnc5yZiXq9Xzc3NysjIaNOekZGh999/v0vvUVxcrMzMTBUUFITtLysr0wMPPHDKtQIAYHfu5NgMM99k+ZqbU1FeXq61a9fqpZdeksvlCjtm7ty58vl8odehQ4eiXCUAAIgmS8/cGIahhIQE1dbWtmmvra3VkCFDOjz20UcfVXl5uV5//XXl5OScdJzT6ZTT6eyRegEAQN9n6Zkbh8OhMWPGqKKiItTW0tKiiooK5eXlnfS4hx9+WAsXLtSmTZs0duzYaJQKAABihOXPlioqKtKMGTM0duxYjRs3TkuXLtWxY8c0c+ZMSdL06dM1bNgwlZWVSZIWL16sBQsW6Nlnn1V2drZqamokSSkpKUpJSbHsewAAgL7B8nAzZcoUHTlyRAsWLFBNTY1GjRqlTZs2hRYZHzx4UPHx/zrB9PjjjysYDOo///M/27xPaWmp7r///miWDgAA+iDL73MTbdznBgCA2BPJ73dM75YCAAD4JsINAACwFcINAACwFcINAACwFcINAACwFcINAACwFcINAACwFcINAACwFcINAACwFcINAACwFcINAACwFcINAACwFcINAACwFcINAACwFcINAACwFcINAACwFcINAACwFcINAACwFcINAACwFcINAACwlQFWFwAAAGKTrz4obyAof0OT0pISZQx0yJ3ssLoswg0AAIjc4aPHVby+Sm9We0Nt+R5D5YU5ykxPsrAyLksBAIAI+eqD7YKN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23Trrbdq7969pz5ZAHpOrz93HEC/dNlll5kjRowwW1paQm3FxcXmiBEjTNM0zTPPPNOcPHlym2NuuOEG8+abb27T9uabb5rx8fHm8ePHzb1795qSzNdeey3sZ77xxhumJPPLL780TdM0R44cad5///1dGnvdddeZ3/ve99qMufvuu83zzjsv9PeZZ55p/vSnPw393dLSYg4ePNh8/PHHO5gJANHGmRsAveaSSy5ps1g3Ly9P1dXVam5uliSNHTu2zfi//e1vWrNmjVJSUkKviRMnqqWlRQcOHNCuXbuUkJCgyy67rEuff8cdd+ihhx7S+PHjVVpaqqqqqpOO3bNnj8aPH9+mbfz48W3qlaScnJzQf46Li9OQIUP02WefdakeANFBuAFgmYEDB7b5OxAI6Oc//7l27doVev3tb39TdXW1hg8frqSkpIje/8Ybb9T+/fs1bdo07d69W2PHjtWyZctOqebExMQ2f8fFxamlpeWU3hNAzyLcAOg1//u//9vm73feeUcej0cJCQlhx1900UV67733dPbZZ7d7ORwOjRw5Ui0tLfrrX//a5RqysrJ0yy236MUXX9Rdd92lVatWhR03YsQIbdmypU3bli1bdM4555y0XgB9E+EGQK85ePCgioqKtHfvXj333HNatmyZ7rzzzpOOLy4u1ttvv63Zs2dr165dqq6u1n//93+HFhRnZ2drxowZuv766/Xyyy/rwIED2rx5s55//vmw7/eLX/xCr7zyig4cOKAdO3bojTfe0IgRI8KOveuuu1RRUaGFCxfqgw8+0NNPP63ly5frl7/85alPBICoGmB1AQDsa/r06Tp+/LjGjRunhIQE3XnnnaEt3+Hk5OTor3/9q+bNm6cJEybINE0NHz5cU6ZMCY15/PHHde+99+q2227T559/rjPOOEP33ntv2Pdrbm7WrFmz9M9//lNpaWn6wQ9+oP/6r/8KO/aiiy7S888/rwULFmjhwoUaOnSoHnzwQf3sZz87pTkAEH3cxA9Ar7j88ss1atQoLV261OpSAPQzXJYCAAC2QrgBAAC2wmUpAABgK5y5AQAAtkK4AQAAtkK4AQAAtkK4AQAAtkK4AQAAtkK4AQAAtkK4AQAAtkK4AQAAtvL/ACIEchB4eysTAAAAAElFTkSuQmCC\n",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>precision</th>\n",
       "      <th>recall</th>\n",
       "      <th>th</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.020979</td>\n",
       "      <td>0.95</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>0.991870</td>\n",
       "      <td>0.106643</td>\n",
       "      <td>0.90</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>0.964567</td>\n",
       "      <td>0.214161</td>\n",
       "      <td>0.85</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>0.945596</td>\n",
       "      <td>0.319056</td>\n",
       "      <td>0.80</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>0.919028</td>\n",
       "      <td>0.396853</td>\n",
       "      <td>0.75</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>0.900840</td>\n",
       "      <td>0.468531</td>\n",
       "      <td>0.70</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>0.856938</td>\n",
       "      <td>0.523601</td>\n",
       "      <td>0.65</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>0.830594</td>\n",
       "      <td>0.574301</td>\n",
       "      <td>0.60</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>0.806780</td>\n",
       "      <td>0.624126</td>\n",
       "      <td>0.55</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>0.784000</td>\n",
       "      <td>0.685315</td>\n",
       "      <td>0.50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>0.762681</td>\n",
       "      <td>0.736014</td>\n",
       "      <td>0.45</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>0.732899</td>\n",
       "      <td>0.786713</td>\n",
       "      <td>0.40</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>0.710370</td>\n",
       "      <td>0.838287</td>\n",
       "      <td>0.35</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0.681666</td>\n",
       "      <td>0.887238</td>\n",
       "      <td>0.30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0.650367</td>\n",
       "      <td>0.930070</td>\n",
       "      <td>0.25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0.623801</td>\n",
       "      <td>0.966783</td>\n",
       "      <td>0.20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0.594723</td>\n",
       "      <td>0.985140</td>\n",
       "      <td>0.15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0.573795</td>\n",
       "      <td>0.999126</td>\n",
       "      <td>0.10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.99</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    precision    recall    th\n",
       "17   1.000000  0.020979  0.95\n",
       "16   0.991870  0.106643  0.90\n",
       "15   0.964567  0.214161  0.85\n",
       "14   0.945596  0.319056  0.80\n",
       "13   0.919028  0.396853  0.75\n",
       "12   0.900840  0.468531  0.70\n",
       "11   0.856938  0.523601  0.65\n",
       "10   0.830594  0.574301  0.60\n",
       "9    0.806780  0.624126  0.55\n",
       "8    0.784000  0.685315  0.50\n",
       "7    0.762681  0.736014  0.45\n",
       "6    0.732899  0.786713  0.40\n",
       "5    0.710370  0.838287  0.35\n",
       "4    0.681666  0.887238  0.30\n",
       "3    0.650367  0.930070  0.25\n",
       "2    0.623801  0.966783  0.20\n",
       "1    0.594723  0.985140  0.15\n",
       "0    0.573795  0.999126  0.10\n",
       "18   0.000000  0.000000  0.99"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "plot_precision_recall(test_scores,  test_y)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "39eddef7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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/PrXvzZOnToV4qrDT0/mubm52XjwwQeNUaNGGTExMYbL5TJuv/1246uvvgp94WHkrbfe6vC/t61zO3v2bGPq1Kntjhk3bpxhs9mM8847z/jDH/7Q73VGGAbn3wAAgHVwzw0AALAUwg0AALAUwg0AALAUwg0AALAUwg0AALAUwg0AALAUwg0AALAUwg0AALAUwg0Ay9i2bZsiIiJ04sSJoI4FEF7YoRiAZfh8Ph0/flzJycmKiIgI2lgA4YVwA2BA8Pl8PPUaQFBwWQpAv/jud7+refPmad68eXI4HHI6nVq0aJFa/38qLS1NS5Ys0axZs5SYmKhbbrlFkvTOO+9oypQpio2Nlcvl0p133qn6+vrA+zY1NamwsFAul0t2u13nn3++nnnmGUntLzV9+umnmjZtmoYNG6ahQ4fqoosu0pYtWzocK0mbNm3SRRddJLvdrrS0ND3xxBNtPlNaWpqWLl2qG264QQkJCTrnnHP01FNP9dcUAuglwg2AfvPss89qyJAh2rVrl377299q+fLlevrppwP9jz/+uC655BLt3btXixYt0scff6wf/vCHysvLU0VFhTZu3Kh33nlH8+bNCxwza9YsvfDCC/rP//xPHThwQL///e8VHx/f4e+fO3eumpqaVF5erv3792vZsmVnHLt7925dd911+ulPf6r9+/frwQcf1KJFi7R+/fo245544glNnDhRe/fu1e23367bbrtNBw8e7PtkAQiefn/uOIBBaerUqcaYMWMMv98faCssLDTGjBljGIZhnHvuucb06dPbHHPjjTcat9xyS5u2t99+24iMjDROnjxpHDx40JBkvPHGGx3+zrfeesuQZHz11VeGYRjG2LFjjQcffLBbY6+//nrj+9//fpsx9957r3HhhRcGfj733HONn//854Gf/X6/MXz4cOPJJ5/sZCYAhBpnbgD0m8svv7zNzbpZWVmqrKxUS0uLJGnixIltxv/973/X+vXrFR8fH3jl5ubK7/fr8OHD2rdvn6KiojR16tRu/f4777xTjzzyiCZPnqzi4mJVVFScceyBAwc0efLkNm2TJ09uU68kZWRkBP45IiJCI0aM0BdffNGtegCEBuEGgGmGDh3a5ue6ujr98pe/1L59+wKvv//976qsrNSoUaMUGxvbo/e/6aabdOjQIc2cOVP79+/XxIkTtXLlyj7VHB0d3ebniIgI+f3+Pr0ngOAi3ADoN//zP//T5ud3331X6enpioqK6nD8pZdeqvfff1/nn39+u5fNZtPYsWPl9/v1t7/9rds1uFwu3XrrrXr55Zd1zz33aO3atR2OGzNmjLZv396mbfv27Ro9evQZ6wUwMBFuAPSbqqoqFRQU6ODBg3rhhRe0cuVK3XXXXWccX1hYqB07dmjevHnat2+fKisr9V//9V+BG4rT0tI0e/Zs3XDDDXr11Vd1+PBhbdu2TS+++GKH73f33Xfrtdde0+HDh7Vnzx699dZbGjNmTIdj77nnHpWVlWnJkiX68MMP9eyzz2rVqlX61a9+1feJABBSQ8wuAIB1zZo1SydPntSkSZMUFRWlu+66K7DkuyMZGRn629/+poULF2rKlCkyDEOjRo1Sfn5+YMyTTz6p+++/X7fffru+/PJLnXPOObr//vs7fL+WlhbNnTtX//rXv5SYmKgf/vCH+s1vftPh2EsvvVQvvviiFi9erCVLliglJUUPP/ywfvGLX/RpDgCEHpv4AegX3/3udzVu3DitWLHC7FIADDJclgIAAJZCuAEAAJbCZSkAAGApnLkBAACWQrgBAACWQrgBAACWQrgBAACWQrgBAACWQrgBAACWQrgBAACWQrgBAACW8v8ABGBbyxMDEXIAAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>precision</th>\n",
       "      <th>recall</th>\n",
       "      <th>th</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.023159</td>\n",
       "      <td>0.95</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>0.994545</td>\n",
       "      <td>0.119511</td>\n",
       "      <td>0.90</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>0.982944</td>\n",
       "      <td>0.239240</td>\n",
       "      <td>0.85</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>0.961516</td>\n",
       "      <td>0.360280</td>\n",
       "      <td>0.80</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>0.949634</td>\n",
       "      <td>0.453135</td>\n",
       "      <td>0.75</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>0.929183</td>\n",
       "      <td>0.521739</td>\n",
       "      <td>0.70</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>0.912024</td>\n",
       "      <td>0.586629</td>\n",
       "      <td>0.65</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>0.890336</td>\n",
       "      <td>0.642124</td>\n",
       "      <td>0.60</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>0.867388</td>\n",
       "      <td>0.700240</td>\n",
       "      <td>0.55</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>0.841309</td>\n",
       "      <td>0.752895</td>\n",
       "      <td>0.50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>0.819296</td>\n",
       "      <td>0.803365</td>\n",
       "      <td>0.45</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>0.785051</td>\n",
       "      <td>0.849028</td>\n",
       "      <td>0.40</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>0.751949</td>\n",
       "      <td>0.884859</td>\n",
       "      <td>0.35</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0.715060</td>\n",
       "      <td>0.922220</td>\n",
       "      <td>0.30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0.678883</td>\n",
       "      <td>0.951060</td>\n",
       "      <td>0.25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0.638289</td>\n",
       "      <td>0.974656</td>\n",
       "      <td>0.20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0.602310</td>\n",
       "      <td>0.991042</td>\n",
       "      <td>0.15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0.576395</td>\n",
       "      <td>0.999782</td>\n",
       "      <td>0.10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.99</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    precision    recall    th\n",
       "17   1.000000  0.023159  0.95\n",
       "16   0.994545  0.119511  0.90\n",
       "15   0.982944  0.239240  0.85\n",
       "14   0.961516  0.360280  0.80\n",
       "13   0.949634  0.453135  0.75\n",
       "12   0.929183  0.521739  0.70\n",
       "11   0.912024  0.586629  0.65\n",
       "10   0.890336  0.642124  0.60\n",
       "9    0.867388  0.700240  0.55\n",
       "8    0.841309  0.752895  0.50\n",
       "7    0.819296  0.803365  0.45\n",
       "6    0.785051  0.849028  0.40\n",
       "5    0.751949  0.884859  0.35\n",
       "4    0.715060  0.922220  0.30\n",
       "3    0.678883  0.951060  0.25\n",
       "2    0.638289  0.974656  0.20\n",
       "1    0.602310  0.991042  0.15\n",
       "0    0.576395  0.999782  0.10\n",
       "18   0.000000  0.000000  0.99"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "plot_precision_recall(train_scores, train_y)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "efe41d62",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python (kaggle1)",
   "language": "python",
   "name": "kaggle1"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
